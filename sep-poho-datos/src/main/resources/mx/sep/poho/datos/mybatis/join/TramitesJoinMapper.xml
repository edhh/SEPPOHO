<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">



<mapper namespace="mx.sep.poho.dao.join.TramitesJoinMapper">
  <resultMap id="contratoResultMap" type="mx.sep.poho.datos.vo.ContratoVO" >
    <result column="ANNIO" property="annio" jdbcType="INTEGER" />
    <result column="NU_TRAMITE" property="noTramite" jdbcType="INTEGER" />
    <result column="CVE_CODIGO" property="claveNivel" jdbcType="VARCHAR" />
    <result column="PERIODO" property="periodo" jdbcType="VARCHAR" />
    <result column="CVE_UNIDAD" property="claveUnidad" jdbcType="VARCHAR" />
    <result column="annio" property="estatus" jdbcType="INTEGER" />
  </resultMap>
   
    <select id="obtieneAnniosTramites" parameterType="java.lang.String" resultType="java.lang.Integer">
        SELECT ANNIO FROM TSH003_TRAMITE WHERE RFC = #{rfc,jdbcType=VARCHAR} AND CVE_STATUS = 1036
    </select>
    
    <select id="obtieneContratosXAnnio" resultMap="contratoResultMap">
        SELECT ANNIO, NU_TRAMITE, CVE_CODIGO, (FH_INI) || ' AL ' || (FH_FIN) AS PERIODO , CVE_UNIDAD
            FROM TSH003_TRAMITE WHERE RFC = #{rfc} AND ANNIO = #{annio} AND CVE_STATUS = 1036
    </select>
    
</mapper>   
